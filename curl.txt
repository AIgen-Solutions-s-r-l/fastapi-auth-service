# Authentication Tests

# Register new user (success)
curl -X POST http://localhost:8000/auth/register \
-H "Content-Type: application/json" \
-d '{
  "username": "testuser",
  "email": "test@example.com",
  "password": "SecurePass123!"
}'

# Register new user (error - empty username)
curl -X POST http://localhost:8000/auth/register \
-H "Content-Type: application/json" \
-d '{
  "username": "",
  "email": "test@example.com",
  "password": "SecurePass123!"
}'

# Login (success)
curl -X POST http://localhost:8000/auth/login \
-H "Content-Type: application/json" \
-d '{
  "username": "testuser",
  "password": "SecurePass123!"
}'

# Login (error - invalid credentials)
curl -X POST http://localhost:8000/auth/login \
-H "Content-Type: application/json" \
-d '{
  "username": "testuser",
  "password": "wrongpassword"
}'

# Get current user profile (requires valid token)
curl -X GET http://localhost:8000/auth/me \
-H "Authorization: Bearer YOUR_ACCESS_TOKEN"

# Change password (requires valid token)
curl -X PUT http://localhost:8000/auth/users/testuser/password \
-H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
-H "Content-Type: application/json" \
-d '{
  "current_password": "SecurePass123!",
  "new_password": "NewSecurePass456!"
}'

# Request password reset
curl -X POST http://localhost:8000/auth/password-reset-request \
-H "Content-Type: application/json" \
-d '{
  "email": "test@example.com"
}'

# Reset password with token
curl -X POST http://localhost:8000/auth/reset-password \
-H "Content-Type: application/json" \
-d '{
  "token": "YOUR_RESET_TOKEN",
  "new_password": "NewSecurePass789!"
}'

# Refresh token
curl -X POST http://localhost:8000/auth/refresh \
-H "Content-Type: application/json" \
-d '{
  "token": "YOUR_ACCESS_TOKEN"
}'

# Logout (requires valid token)
curl -X POST http://localhost:8000/auth/logout \
-H "Authorization: Bearer YOUR_ACCESS_TOKEN"

# Delete user account (requires valid token)
curl -X DELETE http://localhost:8000/auth/users/testuser \
-H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
-d "password=SecurePass123!"

# Credit System Tests

# Get credit balance (requires valid token)
curl -X GET http://localhost:8000/credits/balance \
-H "Authorization: Bearer YOUR_ACCESS_TOKEN"

# Add credits (requires valid token)
curl -X POST http://localhost:8000/credits/add \
-H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
-H "Content-Type: application/json" \
-d '{
  "amount": 100.50,
  "reference_id": "payment_123",
  "description": "Initial credit purchase"
}'

# Use credits (success - requires valid token)
curl -X POST http://localhost:8000/credits/use \
-H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
-H "Content-Type: application/json" \
-d '{
  "amount": 50.25,
  "reference_id": "purchase_456",
  "description": "Service purchase"
}'

# Use credits (error - insufficient balance)
curl -X POST http://localhost:8000/credits/use \
-H "Authorization: Bearer YOUR_ACCESS_TOKEN" \
-H "Content-Type: application/json" \
-d '{
  "amount": 1000000.00,
  "reference_id": "purchase_789",
  "description": "Attempt to use more credits than available"
}'

# Get transaction history (requires valid token)
curl -X GET "http://localhost:8000/credits/transactions?skip=0&limit=50" \
-H "Authorization: Bearer YOUR_ACCESS_TOKEN"

# Health Check

# Get system health status
curl -X GET http://localhost:8000/healthcheck